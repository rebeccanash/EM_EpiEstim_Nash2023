setwd("~/EM_EpiEstim_Nash2023")
# Load daily influenza data
daily_dat <- read.csv("real_data/Flu_Dec09_Jan10.csv")
daily_dat
# Load packages
library(EpiEstim)
library(incidence)
library(dplyr)
library(ggplot2)
library(hrbrthemes)
library(svMisc) # for progress bars
library(scales)
aggregate_inc(daily_dat$Incidence, dt = 7L)
daily_dat
# Load packages
library(EpiEstim)
library(incidence)
library(dplyr)
library(ggplot2)
library(hrbrthemes)
library(svMisc) # for progress bars
library(scales)
# Load daily influenza data
daily_dat <- read.csv("real_data/daily_flu.rds")
# Load daily influenza data
daily_dat <- readRDS("real_data/daily_flu.rds")
aggregate_inc(daily_dat$Incidence, dt = 7L)
daily_dat
# Aggregate
week <- 7
start <- seq(from=1, to=nrow(daily_dat)-6, by=week)
start
end <- start+6
ndays <- nrow(daily_dat$Incidence)
weekly_inc <- numeric(length=length(start))
for (i in 1:length(start)){
weekly_inc[i] <- sum(daily_dat$Incidence[start[i]:end[i]])
}
weekly_inc <- as.integer(weekly_inc)
weekly_inc
aggregate_inc(daily_dat$Incidence, dt = 7L)
# Load packages
library(EpiEstim)
library(incidence)
library(dplyr)
library(ggplot2)
library(hrbrthemes)
library(svMisc) # for progress bars
library(scales)
# Load daily influenza data
daily_inc <- readRDS("real_data/daily_flu.rds")
# Aggregate
weekly_inc <- aggregate_inc(daily_inc$Incidence, dt = 7L)
# Load packages
library(EpiEstim)
library(incidence)
library(dplyr)
library(ggplot2)
library(hrbrthemes)
library(svMisc) # for progress bars
library(scales)
# Load daily influenza data
daily_inc <- readRDS("real_data/daily_flu.rds")
# Aggregate
weekly_inc <- aggregate_inc(daily_inc$Incidence, dt = 7L)
# Aggregate
weekly_inc <- EpiEstim::aggregate_inc(daily_inc$Incidence, dt = 7L)
vignette(EpiEstim)
# Serial interval - Cowling 2009
method <- "parametric_si"
mean_si <- 3.6
sd_si <- 1.6
config <- make_config(mean_si = mean_si,
std_si = sd_si)
# Estimate R
R <- EpiEstim::estimate_R(incid = weekly_inc,
dt = 7L,
dt_out = 7L,
method = method,
config = config)
R
# Estimate R from daily incidence
R_daily <- EpiEstim::estimate_R(incid = daily_inc,
method = method,
config = config)
# Estimate R from daily incidence
R_daily <- EpiEstim::estimate_R(incid = daily_inc$Incidence,
method = method,
config = config)
R_daily
readRDS
make_config
ndays
ndays <- nrow(daily_inc$Incidence)
ndays
nrow(daily_inc$Incidence)
daily_inc
daily_inc$Incidence
ndays <- length(daily_inc$Incidence)
ndays
tmin=seq(from=8,to=ndays-1, 1)
tmax=tmin+1
tmin
tmax
# Estimate R from aggregated incidence (no sliding windows - daily R estimate)
R_agg <- EpiEstim::estimate_R(incid = weekly_inc,
dt = 7L,
dt_out = 1L,
method = method,
config = config)
R_agg
# Estimate R from daily incidence (no sliding windows - daily R estimate)
R_daily <- EpiEstim::estimate_R(incid = daily_inc$Incidence,
method = method,
config = config_daily)
config_daily <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si,
tmin=seq(from=8,to=ndays-1, 1),
tmax=tmin+1)
config_daily <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si,
tmin=seq(from=1,to=ndays-1, 1),
tmax=tmin+1)
# Estimate R from daily incidence (no sliding windows - daily R estimate)
R_daily <- EpiEstim::estimate_R(incid = daily_inc$Incidence,
method = method,
config = config_daily)
seq(from=1,to=ndays-1, 1)
# Serial interval - Cowling 2009
method <- "parametric_si"
mean_si <- 3.6
sd_si <- 1.6
config_sliding <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si)
config_daily <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si,
tmin=seq(from=2,to=ndays-1, 1),
tmax=tmin+1)
# Estimate R from daily incidence (weekly sliding windows)
R_daily_sliding <- EpiEstim::estimate_R(incid = daily_inc$Incidence,
method = method,
config = config)
# Estimate R from aggregated incidence (weekly sliding windows)
R_agg_sliding <- EpiEstim::estimate_R(incid = weekly_inc,
dt = 7L,
dt_out = 7L,
method = method,
config = config)
# Estimate R from daily incidence (no sliding windows - daily R estimate)
R_daily <- EpiEstim::estimate_R(incid = daily_inc$Incidence,
method = method,
config = config_daily)
config_daily <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si,
tmin=seq(from=2,to=ndays-1, 1),
tmax=tmin+1)
config_daily <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si,
t_start = seq(from=2,to=ndays-1, 1),
t_end = tmin+1)
# Estimate R from daily incidence (no sliding windows - daily R estimate)
R_daily <- EpiEstim::estimate_R(incid = daily_inc$Incidence,
method = method,
config = config_daily)
config_daily <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si,
t_start = seq(from=2,to=ndays-1, 1),
t_end = t_start + 1)
seq(from=2,to=ndays-1, 1)
config_daily <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si,
t_start = seq(from=2,to=ndays-1, 1),
t_end = t_start + 1)
# Estimate R from daily incidence (weekly sliding windows)
R_daily_sliding <- EpiEstim::estimate_R(incid = daily_inc$Incidence,
method = method,
config = config)
config_daily <- EpiEstim::make_config(list(mean_si = mean_si,
std_si = sd_si,
t_start = seq(from=2,to=ndays-1, 1),
t_end = t_start + 1))
t_start <- seq(from=2,to=ndays-1, 1)
t_end <-
config_daily <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si,
t_start = t_start,
t_end = t_start + 1)
# Estimate R from daily incidence (no sliding windows - daily R estimate)
R_daily <- EpiEstim::estimate_R(incid = daily_inc$Incidence,
method = method,
config = config_daily)
R_daily
# Estimate R from aggregated incidence (no sliding windows - daily R estimate)
R_agg <- EpiEstim::estimate_R(incid = weekly_inc,
dt = 7L,
dt_out = 2L,
method = method,
config = config)
R_agg
# Estimate R from aggregated incidence (weekly sliding windows)
R_agg_sliding <- EpiEstim::estimate_R(incid = weekly_inc,
dt = 7L,
dt_out = 7L,
method = method,
config = config)
R_agg_sliding
# Estimate R from daily incidence (no sliding windows - daily R estimate)
R_daily <- EpiEstim::estimate_R(incid = daily_inc$Incidence,
method = method,
config = config_daily)
R_daily
R_agg
R_agg_sliding
# Load daily influenza data
daily_inc <- readRDS("real_data/daily_flu.rds")
ndays <- length(daily_inc$Incidence)
# Aggregate to weekly
weekly_inc <- EpiEstim::aggregate_inc(daily_inc$Incidence, dt = 7L)
# Serial interval - Cowling 2009
method <- "parametric_si"
mean_si <- 3.6
sd_si <- 1.6
config_sliding <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si)
t_start <- seq(from=2,to=ndays-1, 1)
config_daily <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si,
t_start = t_start,
t_end = t_start + 1)
set.seed(6)
# Estimate R from daily incidence (weekly sliding windows)
R_daily_sliding <- EpiEstim::estimate_R(incid = daily_inc$Incidence,
method = method,
config = config)
# Estimate R from aggregated incidence (weekly sliding windows)
R_agg_sliding <- EpiEstim::estimate_R(incid = weekly_inc,
dt = 7L,
dt_out = 7L,
method = method,
config = config)
# Estimate R from daily incidence (no sliding windows - daily R estimate)
R_daily <- EpiEstim::estimate_R(incid = daily_inc$Incidence,
method = method,
config = config_daily)
# Estimate R from aggregated incidence (no sliding windows - daily R estimate)
R_agg <- EpiEstim::estimate_R(incid = weekly_inc,
dt = 7L,
dt_out = 2L, ## CHECK
method = method,
config = config)
R_agg_sliding
weekly_inc
# Load packages
library(EpiEstim)
library(ggplot2)
library(hrbrthemes)
library(scales)
# Load daily influenza data
daily_inc <- readRDS("real_data/daily_flu.rds")
ndays <- length(daily_inc$Incidence)
# Aggregate to weekly
weekly_inc <- EpiEstim::aggregate_inc(daily_inc$Incidence, dt = 7L)
# Serial interval - Cowling 2009
method <- "parametric_si"
mean_si <- 3.6
sd_si <- 1.6
config_sliding <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si)
t_start <- seq(from=2,to=ndays-1, 1)
config_daily <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si,
t_start = t_start,
t_end = t_start + 1)
set.seed(6)
# Estimate R from daily incidence (weekly sliding windows)
R_daily_sliding <- EpiEstim::estimate_R(incid = daily_inc$Incidence,
method = method,
config = config)
config <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si)
t_start <- seq(from=2,to=ndays-1, 1)
config_daily <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si,
t_start = t_start,
t_end = t_start + 1)
set.seed(6)
# Estimate R from daily incidence (weekly sliding windows)
R_daily_sliding <- EpiEstim::estimate_R(incid = daily_inc$Incidence,
method = method,
config = config)
# Estimate R from aggregated incidence (weekly sliding windows)
R_agg_sliding <- EpiEstim::estimate_R(incid = weekly_inc,
dt = 7L,
dt_out = 7L,
method = method,
config = config)
# Estimate R from daily incidence (no sliding windows - daily R estimate)
R_daily <- EpiEstim::estimate_R(incid = daily_inc$Incidence,
method = method,
config = config_daily)
# Estimate R from aggregated incidence (no sliding windows - daily R estimate)
R_agg <- EpiEstim::estimate_R(incid = weekly_inc,
dt = 7L,
dt_out = 2L, ## CHECK
method = method,
config = config)
R_agg_sliding
R_agg$I
R_agg_sliding$I
length(R_agg$I)
R_agg$R
R_agg_sliding$R
R_agg_sliding$I
length(R_agg_sliding$I)
R_agg_sliding$R$`Mean(R)`
R_agg_sliding$R$`Mean(R)`
R_agg_sliding$R$`Mean(R)`
test_weekly <- readRDS("~/OneDrive - Imperial College London/PhD/Project2_Weekly/Real data estimations/Flu/result_weekly_flu.rds")
test_weekly$recon_inc
test_weekly$recon_inc[,10]
R_daily_sliding_test <- EpiEstim::estimate_R(incid = old_recon_inc,
method = method,
config = config)
old_recon_inc <- test_weekly$recon_inc[,10]
R_daily_sliding_test <- EpiEstim::estimate_R(incid = old_recon_inc,
method = method,
config = config)
R_daily_sliding_test$R
remotes::install_github("mrc-ide/EpiEstim@recon_opt")
# Load packages
library(EpiEstim)
library(ggplot2)
library(hrbrthemes)
library(scales)
# Load daily influenza data
daily_inc <- readRDS("real_data/daily_flu.rds")
ndays <- length(daily_inc$Incidence)
# Aggregate to weekly
weekly_inc <- EpiEstim::aggregate_inc(daily_inc$Incidence, dt = 7L)
# Serial interval - Cowling 2009
method <- "parametric_si"
mean_si <- 3.6
sd_si <- 1.6
config <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si)
t_start <- seq(from=2,to=ndays-1, 1)
config_daily <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si,
t_start = t_start,
t_end = t_start + 1)
set.seed(6)
# Estimate R from daily incidence (weekly sliding windows)
R_daily_sliding <- EpiEstim::estimate_R(incid = daily_inc$Incidence,
method = method,
config = config)
# Estimate R from aggregated incidence (weekly sliding windows)
R_agg_sliding <- EpiEstim::estimate_R(incid = weekly_inc,
dt = 7L,
dt_out = 7L,
recon_opt = "match",
method = method,
config = config)
# Load packages
library(EpiEstim)
library(ggplot2)
library(hrbrthemes)
library(scales)
# Load daily influenza data
daily_inc <- readRDS("real_data/daily_flu.rds")
ndays <- length(daily_inc$Incidence)
# Aggregate to weekly
weekly_inc <- EpiEstim::aggregate_inc(daily_inc$Incidence, dt = 7L)
# Serial interval - Cowling 2009
method <- "parametric_si"
mean_si <- 3.6
sd_si <- 1.6
config <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si)
t_start <- seq(from=2,to=ndays-1, 1)
config_daily <- EpiEstim::make_config(mean_si = mean_si,
std_si = sd_si,
t_start = t_start,
t_end = t_start + 1)
set.seed(6)
# Estimate R from daily incidence (weekly sliding windows)
R_daily_sliding <- EpiEstim::estimate_R(incid = daily_inc$Incidence,
method = method,
config = config)
# Estimate R from aggregated incidence (weekly sliding windows)
R_agg_sliding <- EpiEstim::estimate_R(incid = weekly_inc,
dt = 7L,
dt_out = 7L,
recon_opt = "match",
method = method,
config = config)
